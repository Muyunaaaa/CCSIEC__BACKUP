*注：标记\*为老师重点标注内容*

# *（2019）Improved UAV Opium Poppy Detection Using an Updated YOLOv3 Model

***关键词：MobileNetv2轻量化、单一SSP、GIoU、移动平台、标注细化、负样本***

## 模型改进（SPP-GIoU-YOLOv3-MN)

### 1. 轻量化主干网

- 原 **YOLOv3** 使用的是 **Darknet-53**。
- 本文用 **MobileNetv2** 替代其主干网络，使得模型更加轻量，便于部署在计算资源有限的场景中（如移动平台）。

### 2. 空间金字塔池化（SPP）

- 在预测头中引入了一个 **SPP（Spatial Pyramid Pooling）模块**，增强了模型**对不同尺度目标**（特别是大型目标）的检测能力。

### 3. 边框回归损失函数改进（GIoU）

- 使用 **GIoU（Generalized IoU）** 替代传统的 IoU 作为边框回归损失函数，提高边界框预测精度。

---

## 数据集与训练方法

- 使用了**UAV（无人机）采集的罂粟图像数据集**，包含不同飞行高度和罂粟生长阶段的图像。
- 图像被裁剪为 **416×416 像素**进行训练，采用了数据增强策略。
- 使用 <u>mAP、F2 Score、FPS、模型参数量</u>等指标进行评估。

---

## 模型性能分析与对比

### 1. 与原始 YOLOv3 对比

- **SPP-GIoU-YOLOv3-MN 在 AP（平均精度）上达到了 96.37%，速度达 29 FPS**，优于原始 YOLOv3。
- 模型更轻量，计算效率更高。

### 2. 测试不同 SPP 单元结构的影响（单个 SPP vs. 多个 SPP）

- 在不同检测阶段添加多个 SPP 模块（SPP3-YOLOv3-MN）后，虽然**收敛速度稍快**，但：
  - 精度提升有限，仅提高 0.16%；
  - 模型参数更大，检测速度下降。
- 结论：**单一 SPP 更划算**，多 SPP 模块带来的代价大于收益。

---

## 数据集局限性分析

### 1. 罂粟本身的复杂性

- 生长阶段和拍摄高度影响检测难度，尤其是在非开花期和高空拍摄时更难识别。
- 建议将**标注细化为不同阶段和高度**，提高模型泛化能力。

### 2. 背景复杂性

- 真实无人机图像中包含建筑、其他植物等复杂背景。
- 当前数据集中裁剪的图片较简单，建议引入**更多负样本**来提升鲁棒性和减少误检。



# *（2021）**Low-Altitude Remote Sensing Opium Poppy Image Detection **Based on Modified YOLOv3****

***关键词:LabelImg人工标注、分为训练集和测试集、PASCAL VOC2007、预测层、空洞卷积、TensorFlow框架、训练参数***

## 数据采集与预处理

- 采集了5325张低空无人机拍摄的罂粟地遥感图像。
- 使用**LabelImg**软件进行人工标注，标出罂粟目标的类别和边界框。
- 将数据转换为标准的**PASCAL VOC2007**格式，划分为训练集和测试集（8:2比例），保证模型训练和测试的科学性。

------

## 模型改进与设计

- 采用经典目标检测算法YOLOv3作为基础。
- 针对罂粟目标小、遮挡多、复杂背景干扰大的特点，提出“多尺度全局特征融合改进方案”：
  - 在原YOLOv3基础上新增了一个104×104分辨率的**预测层**，增强对小目标的检测能力。
  - 引入**空洞卷积**(dilated convolution)替代部分卷积层，以扩大感受野，提高对细节特征的捕捉。
  - 使用改进的特征融合策略，增强多尺度信息的综合表达。
- 这些改进有效提升了模型对罂粟目标的识别精度和鲁棒性。

------

##  实验设置与指标

- 采用**TensorFlow框架**，在配备NVIDIA Tesla V100 GPU的服务器上训练模型。
- **训练参数**统一设置为：<u>学习率0.0001，batch size=3，训练250个epoch。</u>
- 评估指标包括P<u>recision、Recall、F1-score、AP和mAP</u>，特别关注模型在小目标检测的表现。
- 设置置**信度阈值**为0.3，**IOU阈值**为0.5，用于判定检测正确与否。

------

## 实验结果与分析

- 改进模型mAP达到92.42%，较原始YOLOv3提升0.45%。
- 模型推理时间约24.5毫秒每张图，比原始模型更快。
- 模型大小缩减至原始的13.75%，适合部署在无人机或边缘设备上。
- 通过对比分析，证明新增预测层和空洞卷积有效提升了对小目标和复杂背景下罂粟的检测性能。
- 实验还揭示了现实中环境干扰（风力引起的模糊）、非法种植隐蔽手段（塑料覆盖、混种）和复杂背景等因素对检测带来的挑战。



# *（2022）**A Two-Stage Low-Altitude Remote Sensing Papaver **Somniferum Image Detection System Based on YOLOv5s+DenseNet121



***关键词：Papaver somniferum检测、YOLOv5s、DenseNet121、两阶段检测方法、图像分割、误报率***

## 1. 数据采集与预处理

- 采集40幅遥感图像，其中包含18幅含罂粟的图像和22幅不含罂粟的图像。
- 将每幅**图像切割**成640×640像素的小图块，共获得4920张图像块。
- 图像块中含20张含罂粟图像块，其余4900张为不含罂粟图像块。
- 数据集用于训练和测试目标检测模型(8:2)

------

## 2. 模型设计与改进

- 采用目标检测模型YOLOv5s作为基础检测器，结合**DenseNet121**作为分类器，构建两阶段检测方法。
- 第一阶段：使用YOLOv5s进行快速目标检测，初步识别疑似罂粟区域。
- 第二阶段：对第一阶段检测出的候选区域，利用DenseNet121分类器进行二次筛选，以减少误报。
- 两阶段方法旨在保持高召回率的同时大幅降低误报率，提升检测准确性。

------

## 3. 训练与测试设置

- 模型训练采用分割后得到的4920张图像块。
- 测试时对所有图像块输入训练好的模型，输出预测结果与实际标签进行比对。
- 重点评估召回率（Recall）和误报数量。
- 通过比较单阶段和两阶段方法的检测效果，验证改进方法的有效性。

------

## 4. 实验结果与分析

- 单阶段YOLOv5s检测：
  - 召回率95%（19/20正确检测含罂粟图像块）。
  - 误报291张图像块。
- 两阶段YOLOv5s + DenseNet121检测：
  - 召回率95%（19/20正确检测含罂粟图像块）。
  - 误报降低至76张图像块，误报率减少73.88%。
- 通过图7可见，单阶段方法误报罂粟图像的置信度较高，简单提升置信度阈值难以根治误报问题。
- 两阶段方法通过二次分类，有效剔除高置信度的非罂粟图像，降低人工复核负担。
- 检测仍面临部分绿色作物难以区分的挑战。

------

## 5. 讨论

- UAV低空遥感技术结合目标检测可有效监测非法罂粟种植。
- 低飞高度提高地面分辨率，增强特征清晰度，但面临飞行安全限制。
- 对比文献中单阶段方法，本文两阶段方法在130-145米飞行高度下取得更高的精确率（97.7%）和召回率（94.9%）。
- 不同生长阶段的罂粟植株在颜色和形态上差异显著，增加了检测难度。
- 数据集规模限制了对种植地块面积与检测准确性关系的定量分析，未来需扩展数据以建立相关函数。

------

## 6. 结论

- 本文提出的两阶段检测方法成功将误报率降低73.88%，召回率保持95%，有效减轻后续人工审核压力。
- 该方法在技术上可作为无人机监测非法罂粟种植的有效工具。
- 未来工作重点在于扩充样本多样性和研究种植地块面积与检测性能的关系。



# *（2023）**Fast Opium Poppy Detection in Unmanned Aerial Vehicle (UAV) Imagery Based on Deep Neural Network**

***关键词：YOLOv5s、YOLOv6-Tiny、高低尺度特征注意力模块（HLA）、重复学习、模型剪枝（RepBlock->HLC)、VisDrone2019数据集***

## 1. 数据集与预处理

- 使用自建无人机罂粟遥感图像数据集，图像包含多尺度和复杂背景的罂粟目标。
- 采用标准训练/测试划分，确保模型泛化能力评估合理。
- 对图像进行**常规增强和预处理**以提高模型鲁棒性。

------

## 2. 模型设计与改进

- 基于**YOLOv5s**和**YOLOv6-Tiny**模型，设计**高低尺度特征注意力模块（HLA）**，增强特征提取的表达能力。
- HLA模块有效结合低尺度与高尺度信息，提高对小目标和复杂背景的识别能力。
- 在YOLOv6-Tiny中**替换RepBlock为轻量级HLC模块**，兼顾精度与推理速度。

------

## 3. 训练策略创新

- 提出**重复学习**训练策略，**反复挖掘难样本**，强化模型对难识别目标的学习能力。
- 通过**多阶段训练**，提升模型的召回率和准确率，特别是在背景复杂和目标相似度高的场景下效果显著。
- 对比传统训练方法，重复学习策略带来明显性能提升。

------

## 4. 实验结果与分析

- **注意力机制对比：**
  - HLA模块在Drones 2023数据集上使mAP提升最高达2.5%，超过SE、CA、ECA、CBAM等主流机制。
  - F1分数略低于SE模块，但计算复杂度更低，适合轻量化需求。
- **重复学习效果：**
  - 结合HLA的YOLOv5s与YOLOv6-Tiny模型，通过重复学习训练策略，显著提升F1和mAP。
  - 视觉结果显示对相似纹理目标识别更加准确。
- **模型剪枝实验：**
  - 剪枝率增高，参数减少，推理速度显著提升，但精度有所下降。
  - 通过微调恢复性能，在50%剪枝率下，实现约23%推理速度加速，保持接近原始准确率。

------

## 5. 讨论

- 在**VisDrone2019数据集**上，与其他轻量级模型相比，提出方法保持较高准确率，展现良好泛化能力。
- 重复学习策略虽提升性能，但训练时间增加，需权衡效率。
- 小尺度目标检测仍存在挑战，未来可优化多尺度融合及样本采样策略。

------

## 6. 结论

- 设计的HLA注意力模块与重复学习策略有效提升无人机罂粟检测性能。
- 结合结构化剪枝实现模型轻量化，满足嵌入式实时应用需求。
- 在自建数据集上取得**F1=0.855、mAP=0.882**的优异表现，嵌入式推理速度达**172fps**。
- 未来工作将聚焦大规模图像的多尺度目标检测及模型在嵌入式平台的进一步优化，拓展至其他农作物检测任务。





# *（2024）Detection and Recognition of Poppy in UAV Imagery Based on Deep Neural Networks

***关键词：epoch、SGD优化器、SD-YOLO、DC-C2f模块、SD-attention、SPD-Conv、Mosaic数据增强技术、Faster R-CNN、空间-深度变换、多尺度特征融合***

## 1. 数据集与预处理

- 使用无人机遥感罂粟数据集，包含多尺度且复杂背景下的小目标图像。
- 采用640×640尺寸输入，结合Mosaic数据增强技术，提高模型泛化能力。
- 训练使用300个epoch，批量大小64，学习率0.01，SGD优化器。

------

## 2. 模型设计与改进

- 基于YOLOv8框架，设计集成**DC-C2f模块**、**SD-attention检测头**和**SPD-Conv卷积结构**，提升对**小目标**的检测能力。
- **SPD-Conv模块**通过**空间切片重组**，将空间信息转换为通道信息，增强特征表达密度，专注小目标特征提取。
- 采用**多层特征融合**及动态注意力机制，增强多尺度目标检测适应性。
- 保持模型轻量化设计，兼顾检测精度与计算效率。

------

## 3. 训练策略

- 训练采用标准策略，启用缓存机制提升训练效率。
- 使用Mosaic增强，提升小目标在复杂背景下的识别鲁棒性。
- 设置300轮充分训练，保证模型收敛与稳定性能。

------

## 4. 实验结果与分析

- **消融实验：**
  - 基线YOLOv8 mAP为61.7%；加入DC-C2f提升至65.1%；引入SD-attention提升至70.2%；再加SPD-Conv达到72.9%，显著提升小目标检测效果。
  - 召回率和精度均有显著提升，综合性能明显优于基线。
- **对比实验：**
  - SD-YOLO在召回率81%、精度80.8%、mAP 72.9%指标上超越Faster R-CNN、SSD、YOLOv5/8/10/11等主流检测模型。
  - 参数量3.3M，虽略高于部分轻量级模型，但适合嵌入式设备部署。

------

## 5. 讨论

- 设计的空间-深度卷积和多层注意力机制有效提升了模型对小尺度罂粟目标的敏感度和识别能力。
- 模型在准确性与复杂度之间取得较好平衡，适合资源受限的无人机平台。
- 参数增加带来一定计算成本，未来需继续优化模型轻量化以提升部署效率。

------

## 6. 结论

- 提出**基于DC-C2f、SD-attention及SPD-Conv的SD-YOLO模型**，显著提升无人机罂粟检测精度。
- 多层特征融合与动态注意力机制增强了多尺度目标检测能力，降低漏检率。
- 尽管模型参数有所增加，仍满足嵌入式设备需求，具备良好应用前景。
- 未来计划聚焦参数优化及扩展至其他农作物检测任务，实现更广泛的智能农业应用。



# （2020）Identification of poppy by spectral matching classification

***关键词： 高光谱成像、光谱匹配分类***

1. 植物的光谱信号非常相似，需要较高的光谱识别能力。
2. 利用无人机上的小型光谱成像仪探测
3. 利用光谱匹配分类技术对罂粟叶片进行分辨。
4. 利用特定算法对光谱图像的像素进行处理



# （2022）Early and on-ground image-based detection of poppy (Papaver rhoeas) in wheat using YOLO architectures

***关键词：杂草识别、Mosaic数据增强、ResNet-18***

注：这里是对杂草的识别，因此对小目标检测要求较高，需要斟酌

------

## 1. 数据集与预处理

- 使用地面近距离RGB图像采集的**田间实景小麦田数据集**，自然状态下混杂大量**P. rhoeas（罂粟）幼苗**。
- 图像分辨率约为**0.5 mm/pixel**，相较于以往研究中使用的高分辨率图像（0.1–0.5 mm）略低。
- 检测目标处于**BBCH 12-14生育期（2-4片真叶）**，识别难度大但正值除草关键期。
- 数据集自然背景复杂，未人为隔离作物与杂草，检测任务更具挑战性与实用性。

------

## 2. 模型设计与改进

- 对比研究了YOLOv3、YOLOv4（含P5变种）及YOLOv5等**6种YOLO系列模型**，重点评估**小目标检测能力与运行速度**。
- 最终确定以**YOLOv5s模型**为最佳方案，其轻量化结构适合**实时田间检测与嵌入式部署**。
- 检测流程以**目标检测为核心**，便于后续与智能喷药设备（如窄幅喷头）联动，实现精确除草。

------

## 3. 训练策略

- 使用YOLO默认训练框架，输入图像尺寸为640×640。
- 引入数据增强（如随机裁剪、旋转等）提升模型泛化能力。
- 模型在GPU环境下训练，关注模型**推理速度与检测准确率的权衡**。
- 优化目标聚焦在**保持检测精度前提下实现 >40 FPS 实时处理能力**，满足未来车载部署场景。

------

## 4. 实验结果与分析

- **检测性能：**
  - YOLOv5s在测试集中达到**约75%召回率与75%精度**，优于YOLOv3和YOLOv4大多数变种。
  - 所有模型中除YOLOv4-P5外，均可实现>40 FPS的推理速度，适用于实时系统。
- **对比研究：**
  - 相较于**ResNet-18**在罂粟BBCH 17–19期（6–9片真叶）场景下取得的90%精度，本研究在更早期BBCH 12–14期仍保持优良表现，具备更高实用价值。
  - 对比YOLOv3/YOLOv4在其它杂草（如苋菜、马齿苋、蔓地锦等）识别任务上的mAP 70%-88%之间，本研究YOLOv5表现接近甚至优于多数方案。

------

## 5. 讨论

- 本研究首次将YOLOv5用于**P. rhoeas 幼苗识别**任务，填补相关研究空白。
- YOLOv5s兼具检测速度与准确性，适合实时识别与喷洒系统集成，具备落地应用潜力。
- 数据复杂度高（田间自然杂草共生），进一步证明模型在真实环境下的**鲁棒性与可靠性**。
- 尽管与部分研究在精度上接近，但本研究强调**早期识别**与**复杂背景干扰条件下**的高效检测，实用意义更强。

------

## 6. 结论

- 本文提出基于YOLOv5的P. rhoeas早期识别模型，首次在BBCH 12–14阶段实现高精度检测。
- 实验表明，YOLOv5s在精度、召回率与推理速度方面表现最优，可集成于智能喷药系统，实施**按需精准除草（SSWM）**策略。
- 未来研究可聚焦于：
  - 系统集成：结合GNSS、视频流、微控板与多喷头系统，构建**实时自动喷药平台**；
  - 模型优化：在保持精度基础上，进一步提升模型轻量化水平；
  - 泛化扩展：将该模型推广至其它作物与杂草种类，服务更广泛的**智能农业**场景。



# （2024）**Opium poppy image detection based on improved YOLOV5**

***关键词：多尺度注意力机制（MAM）、YOLOv5、小目标检测、无人机遥感、Mosaic数据增强、Adam优化器、PyTorch、全局平均池化***

## 1. 数据集与预处理

- 数据集包含2358张手工标注的罂粟图像，图像尺寸为640×640像素，数据来源于网络爬取。
- 训练集和测试集划分为2079张和279张，训练集进一步分为训练和验证部分。
- 采用YOLOv5自带的Mosaic数据增强技术，通过随机缩放、裁剪和拼接4张图像，丰富数据多样性并增强模型对小目标的鲁棒性。

------

## 2. 模型设计与改进

- 基于YOLOv5s模型，提出**多尺度注意力机制（MAM）模块**，专门针对无人机小目标罂粟图像设计。
- MAM模块通过**全局平均池化**后使用1×1、1×3、1×5卷积核提取多尺度特征，并融合生成通道注意力权重。
- 注意力权重作用于输入特征图通道，提升模型对小尺度目标的特征提取能力。
- 将MAM模块插入YOLOv5骨干网络中**SSPF与CSP1层**之间，优化特征表示。

------

## 3. 训练策略

- 采用**Adam优化器**，学习率0.001，批量大小16，训练300轮。
- 使用Nvidia GeForce GTX 3090 GPU，PyTorch 1.11.0与CUDA 11.3环境。
- **Mosaic数据增强**结合传统训练，提升模型对多样化场景的适应性。

------

## 4. 实验结果与分析

- 在多个注意力机制模型基础上进行对比，指标包括<u>FLOPS、参数量、精度（Precision）、召回率（Recall）、F1分数及mAP。</u>
- MAM-YOLOv5相较基础YOLOv5s提升精度1.5%至90.3%，F1分数提升1.2%至88.4%，mAP提升至91.4%。
- 模型计算复杂度略高于基础模型（17.6G FLOPS vs 15.9G），参数量基本持平（约7M）。
- 相比其他注意力机制（CA、SE、ECA等），MAM机制在精度和模型复杂度之间实现较优平衡。

------

## 5. 讨论

- 多尺度注意力机制有效增强了模型对小目标特征的感知能力，提升检测准确率。
- 模型在提升性能的同时，保持较低的计算成本，适合无人机实时检测应用。
- 进一步优化空间和结构仍有潜力，特别是在模型轻量化和实时性方面。

------

## 6. 结论

- 提出基于多尺度注意力机制的MAM-YOLOv5模型，显著提升了无人机遥感罂粟图像的小目标检测精度。
- 模型在保持计算效率的基础上，实现了鲁棒性和泛化能力的增强。
- 该改进策略为小目标检测任务提供了有效思路，具备良好的应用推广价值。
- 未来可继续探索更多轻量化设计及多目标检测场景下的适用性。